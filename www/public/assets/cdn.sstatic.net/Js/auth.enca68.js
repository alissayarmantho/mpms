"use strict";var auth={"currentPage":null,"pages":{"SignUp":1,"Login":2,"AddLogin":3,"Password":4},"getSsrc":function(t){var e=$('#login-form input[name="ssrc"]'),n=void 0;return e&&1===e.length&&(n=e.val()),n||(n=t),n},"init":function(t){auth.currentPage=t;var e=[],n=[],a=[],o=[],r=null,i=null,s=null,c=null,u=function(t,e){var n=t.closest(".js-auth-item");n.addClass("has-error"),n.find(".js-alert-icon").removeClass("d-none"),n.find(".js-error-message").removeClass("d-none").append(e)},l=function(t){var e=t.closest(".js-auth-item");e.removeClass("has-error"),e.find(".js-alert-icon").addClass("d-none"),e.find(".js-error-message").addClass("d-none").empty()};if($("#openid-buttons").on("click","[data-provider]",function(e){t===auth.pages.Login&&StackExchange.using("gps",function(){StackExchange.gps.track("login.start",{"tid":StackExchange.options.user.tid},!0)});var n=$(this).data("provider");if(n){var a=!1;t===auth.pages.SignUp&&(StackExchange.using("gps",function(){StackExchange.gps.track("signup.start",{"openid_provider":n,"location":auth.getSsrc("signup_page"),"tid":StackExchange.options.user.tid},!0)}),a=!0),auth.signin($(this),e,a)}}),t===auth.pages.SignUp){var d=$("#se-login-fields");$(d).on("keyup","input[name=password],input[name=display-name],input[name=email]",function(t){var e=$(t.target);if(!e.data("entered")){var n="signup."+e.attr("name").replace("display-","")+".entered";StackExchange.using("gps",function(){StackExchange.gps.track(n,{},!0)}),e.data("entered",!0),StackExchange.options.mustTrackSignupStartForResearchRecruitment&&!d.data("entered")&&($.ajax("/urr/signup-start"),d.data("entered",!0))}}),$("#se-login-fields").on("click","#submit-button",function(){StackExchange.using("gps",function(){StackExchange.gps.track("signup.se.click",{},!0)})}),$(".js-terms").on("click","a[name=privacy],a[name=tos]",function(t){var e=$(t.target),n="signup."+e.attr("name")+".click";StackExchange.using("gps",function(){StackExchange.gps.track(n,{},!0)})}),$(".js-redirects").on("click","a[name=login],a[name=talent]",function(t){var e=$(t.target),n="signup."+e.attr("name")+"_redirect";StackExchange.using("gps",function(){StackExchange.gps.track(n,{},!0)})})}var f=$('<p class="s-input-message fc-red-500"></p>').text("Caps lock is on"),p=$(".js-password"),g=!1;p.keypress(function(t){var e=String.fromCharCode(t.which),n=/[a-z]/i.test(e);if(n){var a=e==e.toUpperCase();g=a&&!t.shiftKey}var o=document.msCapsLockWarningOff===!1,r=o;g&&!r?p.after(f):f.remove()}),p.find("input").blur(function(){f.remove()});var h=!1,m=!1;$("#login-form input").blur(function(e){t===auth.pages.SignUp&&(""==$(e.target).val()||h||(StackExchange.gps.track("signup.start",{"openid_provider":"Stack Exchange","location":auth.getSsrc("signup_page"),"tid":StackExchange.options.user.tid},!0),h=!0)),t===auth.pages.Login&&(""==$(e.target).val()||m||(StackExchange.gps.track("login.start",{"tid":StackExchange.options.user.tid},!0),m=!0))}),$("#login-form input[type='text'], #login-form input[type='password'], #login-form input[type='email']").keypress(function(e){return 13===e.which?($("#submit-button").is(":hidden")||t===auth.pages.AddLogin?$("#login-form").submit():$("#login-form #submit-button").click(),e.preventDefault(),!1):void 0});var v=function(t,e){if(t.length>0){if(null!=e){for(var n=!0,a=0;a<t.length;a++)if(t[a].message==e.message){n=!1;break}t[0].changed=n}return t[0]}},b=function(t){null!=t&&t.changed&&u(t.attachTo,t.message)},k=function(){b(r),b(i),b(c),b(s)},S=function(){e=[],n=[],a=[],o=[],r=null,i=null,s=null,c=null,$(".js-auth-item").removeClass("has-error"),$(".js-alert-icon").addClass("d-none"),$(".js-error-message").addClass("d-none").empty()},y=function(t,e,n){for(var a="all"===e,o=0;o<t.length&&(t[o].id!=e&&!a||(t.splice(o,1),a));o++);n&&l(n)},w=StackExchange.Auth.addOrUpdateError,x=function(e){var a=$("input[name = 'password']"),o=0===$.trim(a.val()).length;if(o&&!e?w(n,{"id":"pw-empty","index":0,"attachTo":a,"message":"Password cannot be empty."}):y(n,"pw-empty",a),t===auth.pages.SignUp||t===auth.pages.Password){StackExchange.Auth.passwordStrengthValidation(a,n,y);var r=$.trim(a.val()),i=$('input[name="password2"]');if(i.length){var s=$.trim(i.val());0===s.length?w(n,{"id":"pw-empty2","index":3,"attachTo":i,"message":"Password confirmation cannot be empty."}):y(n,"pw-empty2",i),s.length>0&&r!==s?w(n,{"id":"pw-match","index":4,"attachTo":i,"message":"The passwords do not match."}):y(n,"pw-match",i)}if(StackExchange.settings.accounts.currentPasswordRequiredForChangingStackIdPassword){var c=$('input[name="currentpassword"]');if(c.length){var u=$.trim(c.val());0===u.length?w(n,{"id":"curpw-empty","index":0,"attachTo":c,"message":"Current password cannot be empty."}):y(n,"curpw-empty",c)}}}},E=function(){var t=$("input[name='email']"),n=0===$.trim(t.val()).length;n?w(e,{"id":"em-empty","index":0,"attachTo":t,"message":"Email cannot be empty."}):y(e,"em-empty",t)},j=function(){var t=$("#no-captcha-here iframe").length>0,e=$(".js-catpcha-error-container");if(t){var n=grecaptcha.getResponse().length>0;n?y(o,"cp",e):w(o,{"id":"cp","index":0,"attachTo":e,"message":"CAPTCHA response required."})}},T=function(){var t=$.trim($("input[name='email']").val()).toUpperCase(),e=$("input[name='display-name']"),n=$.trim(e.val()).toUpperCase();t===n&&""!=t?w(a,{"id":"nm","index":0,"attachTo":e,"message":"Name and email address must be different. If you don't want to enter a name, just leave it blank.","faileType":"name_email_same"}):y(a,"nm",e)},O=function(){return x(),t===auth.pages.SignUp&&(T(),j()),t!=auth.pages.Password&&E(),r=v(e,r),i=v(n,i),s=v(a,s),c=v(o,c),null==r&&null==i&&null==s&&null==c},P=!0;$("#login-form #submit-button").click(function(n){var a={"isSignup":t===auth.pages.SignUp,"isLogin":t===auth.pages.Login,"isPassword":t===auth.pages.Password,"isAddLogin":t===auth.pages.AddLogin};return S(),$("#login-form input").each(function(t,e){var n=$(e).attr("name");n&&(n=n.replace(/(\W|_)/gi,""),a[n]=$(e).val())}),$.ajax({"url":"/users/login-or-signup/validation/track","data":a,"type":"POST","complete":function(){var n=O();return P&&($("#login-form input").blur(function(){if(O(),t===auth.pages.SignUp){var n=$("#login-form input[name='email']"),a=$.trim(n.val());y(e,"em-ajax"),$.ajax({"type":"POST","url":"/users/signup/email/validate","data":{"email":a,"fkey":StackExchange.options.user.fkey},"success":function(a){t!==auth.pages.AddLogin&&(a.IsValid?r=null:(w(e,{"id":"em-ajax","index":1,"attachTo":n,"message":a.ErrorMessage}),r=v(e,r)))},"complete":function(){k()}})}else k()}),P=!1),n?($("#login-form").submit(),void 0):(k(),void 0)}}),n.preventDefault(),!1}),$("#se-pw-reset").submit(function(t){S();var e=O();return e||(k(),t.preventDefault()),e})},"removeAllErrors":function(){},"signin":function(t,e,n){function a(t,e){var n="users_login";auth.currentPage===auth.pages.SignUp&&(n="signup_page",e||StackExchange.using("gps",function(){StackExchange.gps.track("signup.start",{"openid_provider":t,"location":auth.getSsrc(n),"tid":StackExchange.options.user.tid},!0)}),t&&StackExchange.using("gps",function(){StackExchange.gps.track("signup.openid.click",{"openid_provider":t,"location":n},!0)})),t&&StackExchange.using("gps",function(){StackExchange.gps.track("openid.click",{"openid_provider":t,"location":n},!0)})}function o(t){var e={"name":t.data("provider")};return t.data("oauthserver")&&(e.oauth_server=t.data("oauthserver")),t.data("oauthversion")&&(e.oauth_version=t.attr("data-oauthversion")),e}var r=t.data?o(t):t;if(r){if("stack_exchange"===r.name)return a("Stack Exchange",n),void 0;a(r.name.replace(/_/g," "),n),"2.0"===r.oauth_version&&this.setOAuthInfo(r.oauth_version,r.oauth_server),$("#login-form").submit()}},"setOAuthInfo":function(t,e){$("#oauth_version").val(t),$("#oauth_server").val(e)}};